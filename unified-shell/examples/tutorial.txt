# Unified Shell (ushell) - Interactive Tutorial

Welcome to the Unified Shell interactive tutorial!
This tutorial will guide you through all the features step-by-step.

## Prerequisites
- You have built ushell: `make`
- You are running ushell: `./ushell`

---

## PART 1: Getting Started

### Step 1: Check your prompt
You should see a prompt like: username:~/directory>
This shows your current username and directory.

### Step 2: Try the help command
Type: help
This will show you all available commands and features.

### Step 3: Check the version
Type: version
This shows the shell version and build information.

---

## PART 2: Basic Commands

### Step 4: Find out where you are
Type: pwd
This prints your current working directory.

### Step 5: Say hello
Type: echo Hello, World!
The shell displays: Hello, World!

### Step 6: Try echo with multiple words
Type: echo This is a test
Output: This is a test

---

## PART 3: Variables

### Step 7: Set a variable
Type: set NAME=John
This creates a shell variable called NAME with value "John".

### Step 8: Use the variable
Type: echo Hello, $NAME
Output: Hello, John

### Step 9: Set another variable
Type: set AGE=25

### Step 10: Use both variables
Type: echo $NAME is $AGE years old
Output: John is 25 years old

### Step 11: Check all variables
Type: env
This shows all environment variables.

### Step 12: Remove a variable
Type: unset NAME
Type: echo $NAME
Output: (empty - variable is gone)

---

## PART 4: Arithmetic

### Step 13: Simple addition
Type: echo $((5 + 3))
Output: 8

### Step 14: Multiplication
Type: echo $((6 * 7))
Output: 42

### Step 15: Division
Type: echo $((20 / 4))
Output: 5

### Step 16: Modulo (remainder)
Type: echo $((17 % 5))
Output: 2

### Step 17: Arithmetic with variables
Type: set X=10
Type: set Y=5
Type: echo $((X + Y))
Output: 15

### Step 18: Complex expressions
Type: echo $((X * Y + 3))
Output: 53

---

## PART 5: File Operations

### Step 19: Create a file
Type: mytouch test.txt
This creates an empty file called test.txt.

### Step 20: List files
Type: myls
You should see test.txt in the output.

### Step 21: Check file details
Type: mystat test.txt
This shows file size, permissions, timestamps, etc.

### Step 22: Add content to file
Type: echo Hello, File! > test.txt
This writes "Hello, File!" to test.txt.

### Step 23: View file contents
Type: mycat test.txt
Output: Hello, File!

### Step 24: Append to file
Type: echo More content >> test.txt
Type: mycat test.txt
Output:
Hello, File!
More content

### Step 25: Copy the file
Type: mycp test.txt backup.txt
Type: myls
You should see both test.txt and backup.txt.

### Step 26: Remove files
Type: myrm test.txt backup.txt
Type: myls
The files are gone.

---

## PART 6: Directory Operations

### Step 27: Create a directory
Type: mymkdir my_project
Type: myls
You should see my_project/ in the listing.

### Step 28: Change into the directory
Type: cd my_project
Type: pwd
You're now in the my_project directory.

### Step 29: Create files in the directory
Type: mytouch main.c
Type: mytouch header.h
Type: myls
Output: main.c  header.h

### Step 30: Go back up
Type: cd ..
Type: pwd
You're back in the parent directory.

### Step 31: Remove directory contents
Type: myrm my_project/main.c my_project/header.h

### Step 32: Remove the directory
Type: myrmdir my_project
Type: myls
The directory is gone.

---

## PART 7: Conditionals

### Step 33: Simple if statement
Type: if true then
Type: echo Success!
Type: fi
Output: Success!

### Step 34: If with command test
Type: mytouch testfile.txt
Type: if myls testfile.txt then
Type: echo File exists
Type: fi
Output: File exists

### Step 35: If with variables
Type: set FILE=testfile.txt
Type: if mycat $FILE then
Type: echo Read successful
Type: fi
Output: (contents of testfile.txt)
Read successful

### Step 36: Clean up
Type: myrm testfile.txt

---

## PART 8: Pipelines

### Step 37: Create test files
Type: mytouch file1.c file2.c file3.txt

### Step 38: Simple pipeline
Type: myls | myfd .c
Output: file1.c  file2.c
(Only .c files are shown)

### Step 39: Pipeline with echo
Type: echo Testing pipeline | mycat
Output: Testing pipeline

### Step 40: Clean up
Type: myrm file1.c file2.c file3.txt

---

## PART 9: I/O Redirection

### Step 41: Redirect output
Type: echo First line > output.txt
Type: mycat output.txt
Output: First line

### Step 42: Append to file
Type: echo Second line >> output.txt
Type: echo Third line >> output.txt
Type: mycat output.txt
Output:
First line
Second line
Third line

### Step 43: Input redirection
Type: mycat < output.txt
Output:
First line
Second line
Third line

### Step 44: Combine redirections
Type: mycat < output.txt > copy.txt
Type: mycat copy.txt
Output:
First line
Second line
Third line

### Step 45: Clean up
Type: myrm output.txt copy.txt

---

## PART 10: Glob Patterns

### Step 46: Create test files
Type: mytouch test1.txt test2.txt test3.txt data1.txt

### Step 47: Match all .txt files
Type: myls *.txt
Output: data1.txt  test1.txt  test2.txt  test3.txt

### Step 48: Match specific prefix
Type: myls test*.txt
Output: test1.txt  test2.txt  test3.txt

### Step 49: Single character wildcard
Type: myls test?.txt
Output: test1.txt  test2.txt  test3.txt

### Step 50: Character range
Type: myls test[1-2].txt
Output: test1.txt  test2.txt

### Step 51: Clean up
Type: myrm *.txt

---

## PART 11: Advanced Examples

### Step 52: Calculate rectangle area
Type: set WIDTH=15
Type: set HEIGHT=10
Type: echo Area: $((WIDTH * HEIGHT)) square units
Output: Area: 150 square units

### Step 53: File processing workflow
Type: mytouch data.txt
Type: echo Processing... > data.txt
Type: echo Step 1 complete >> data.txt
Type: echo Step 2 complete >> data.txt
Type: if mycat data.txt then
Type: echo File processed successfully
Type: fi
Output:
Processing...
Step 1 complete
Step 2 complete
File processed successfully

Type: myrm data.txt

### Step 54: Project setup
Type: mymkdir project
Type: cd project
Type: mytouch main.c utils.c
Type: myls *.c
Type: cd ..
Type: myrm project/*.c
Type: myrmdir project

---

## PART 12: Completion

Congratulations! You've completed the ushell tutorial!

### What you've learned:
✓ Basic commands (echo, pwd)
✓ Variables (set, export, unset)
✓ Arithmetic expressions ($((expr)))
✓ File operations (mycat, mycp, myrm, mytouch)
✓ Directory operations (cd, mymkdir, myrmdir)
✓ Conditionals (if/then/fi)
✓ Pipelines (cmd1 | cmd2)
✓ I/O redirection (<, >, >>)
✓ Glob patterns (*, ?, [...])

### Next steps:
- Read the User Guide: docs/USER_GUIDE.md
- Try the example scripts: ./ushell < examples/example_scripts.sh
- Explore advanced examples: examples/advanced_examples.sh
- Try the MCP integration tutorial (see below)
- Build your own shell scripts!

### Exit the shell:
Type: exit
or press: Ctrl+D

Thank you for using Unified Shell!

================================================================================

================================================================================
  MCP INTEGRATION TUTORIAL (MODEL CONTEXT PROTOCOL)
================================================================================

The unified shell includes an MCP server for AI agent interaction. This section
walks you through using the MCP protocol to control the shell programmatically.

================================================================================
  PART 13: MCP SERVER BASICS
================================================================================

### Step 55: Start Shell with MCP Enabled

In a new terminal session:
Type: USHELL_MCP_ENABLED=1 ./ushell

The MCP server runs on port 9000 by default.

TIP: Verify the server is running in another terminal:
Type: lsof -i :9000


### Step 56: Test Basic Connectivity

In a separate terminal:
Type: echo '{"id":"1","method":"initialize","params":{}}' | nc localhost 9000

You should receive:
{"id":"1","type":"response","result":{"server":"unified-shell-mcp","version":"1.0"}}


================================================================================
  PART 14: MCP PROTOCOL OPERATIONS
================================================================================

### Step 57: Discover Available Tools
Type: echo '{"id":"2","method":"list_tools","params":{}}' | nc localhost 9000

This returns a JSON list of 50+ available tools.

### Step 58: Execute a Simple Tool
Type: echo '{"id":"3","method":"call_tool","params":{"tool":"pwd","args":{}}}' | nc localhost 9000

The server executes pwd and returns the output.

### Step 59: Execute Tool with Arguments
Type: echo '{"id":"4","method":"call_tool","params":{"tool":"echo","args":{"text":"Hello MCP!"}}}' | nc localhost 9000

The server executes echo with your text.


================================================================================
  PART 15: SPECIAL AI TOOLS
================================================================================

### Step 60: Get Shell Context
Type: echo '{"id":"5","method":"call_tool","params":{"tool":"get_shell_context","args":{}}}' | nc localhost 9000

Returns: Current directory, user, command history, and environment variables.

### Step 61: Search for Commands
Type: echo '{"id":"6","method":"call_tool","params":{"tool":"search_commands","args":{"query":"list files"}}}' | nc localhost 9000

Returns: Relevant commands with relevance scores.

### Step 62: Get Command Suggestions
Type: echo '{"id":"7","method":"call_tool","params":{"tool":"suggest_command","args":{"query":"find Python files"}}}' | nc localhost 9000

Returns: A suggested shell command for your natural language query.


================================================================================
  PART 16: PYTHON CLIENT EXAMPLES
================================================================================

### Step 63: Run Basic Python Client

Change to examples directory:
Type: cd examples

Run the client:
Type: python3 mcp_client_example.py

This demonstrates:
- Connection and initialization
- Tool discovery and listing
- Command execution (pwd, echo)
- Shell context retrieval
- Command search
- Natural language suggestions

### Step 64: Run AI Agent Example

Type: python3 mcp_ai_agent_example.py "Find all text files"

The AI agent will:
1. Connect to MCP server
2. Analyze your query
3. Select the appropriate tool
4. Execute the tool
5. Display results

Try other queries:
- python3 mcp_ai_agent_example.py "What's in my home directory?"
- python3 mcp_ai_agent_example.py "Show current directory"


================================================================================
  PART 17: SECURITY FEATURES
================================================================================

### Step 65: Test Command Blacklist

Type: echo '{"id":"8","method":"call_tool","params":{"tool":"sudo","args":{}}}' | nc localhost 9000

Should return error: "Command 'sudo' is blacklisted for security reasons"

Blacklisted commands: sudo, su, rm, chmod, chown, kill, reboot, shutdown

### Step 66: Test Path Traversal Protection

Type: echo '{"id":"9","method":"call_tool","params":{"tool":"mycat","args":{"file":"../../etc/passwd"}}}' | nc localhost 9000

Should return error: "Path contains dangerous pattern: .."

The server blocks directory traversal attempts.


================================================================================
  PART 18: ADVANCED MCP FEATURES
================================================================================

### Step 67: Enable Audit Logging

Restart shell with audit logging:
Type: USHELL_MCP_ENABLED=1 USHELL_MCP_AUDIT_LOG=/tmp/mcp_audit.log ./ushell

Execute some commands via MCP, then check the log:
Type: cat /tmp/mcp_audit.log

You'll see JSON log entries for each command execution.

### Step 68: Use Custom Port

Type: USHELL_MCP_ENABLED=1 USHELL_MCP_PORT=9001 ./ushell

Connect to the custom port:
Type: echo '{"id":"1","method":"initialize","params":{}}' | nc localhost 9001


================================================================================
  PART 19: AUTOMATED TESTING
================================================================================

### Step 69: Run MCP Test Suite

Change to tests directory:
Type: cd tests

Run all tests:
Type: ./test_mcp_server.sh

This runs comprehensive tests:
- Basic functionality (connection, initialize, tools)
- Special AI tools
- Security (blacklist, injection, path traversal)
- Error handling
- Concurrent execution

### Step 70: Run Specific Test Category

Type: ./test_mcp_server.sh security

Or test other categories:
- ./test_mcp_server.sh basic
- ./test_mcp_server.sh special
- ./test_mcp_server.sh error
- ./test_mcp_server.sh concurrent


================================================================================
  MCP INTEGRATION SCENARIOS
================================================================================

Now that you understand MCP, consider these integration ideas:

1. **AI Shell Assistant** - Build an agent that translates natural language 
   to shell commands and executes them via MCP.

2. **Remote Shell Management** - Create a web dashboard that connects to 
   MCP and provides a graphical interface for shell operations.

3. **Automated Monitoring** - Write scripts that periodically call 
   get_shell_context and system tools to monitor the environment.

4. **CI/CD Integration** - Use MCP in your continuous integration pipeline 
   to execute build and test commands with full tracking.

For comprehensive MCP documentation, see: docs/MCP_INTEGRATION.md

================================================================================
  TUTORIAL COMPLETE!
================================================================================

Congratulations! You've completed both the basic shell tutorial and the 
MCP integration tutorial. You now know how to:

✓ Use all shell commands and features
✓ Enable and configure the MCP server
✓ Use the JSON-RPC protocol for shell interaction
✓ Execute tools programmatically
✓ Leverage special AI tools for intelligent assistance
✓ Build Python clients and AI agents
✓ Test security features
✓ Run automated tests

Thank you for using Unified Shell!


